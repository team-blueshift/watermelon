# 게임 규칙 및 메커닉

## 게임 목표

같은 종류의 과일을 충돌시켜 합성하고, 최종적으로 **수박**을 만들어 최고 점수를 달성합니다.

## 기본 플로우

```
┌─────────────────────────────────────────┐
│            [다음 과일 미리보기]           │
├─────────────────────────────────────────┤
│  ← 좌우 이동 →   [현재 과일]             │
│  ─────────────── 드롭 라인 ────────────── │
│                                         │
│        ○    ○○                        │
│      ○○○  ○○○                       │
│     ●●●●●●●●●●●●●●●●●●●●●            │
│    ●●●●●●●●●●●●●●●●●●●●●●●           │
└─────────────────────────────────────────┘
```

## 게임 상태

### 1. 대기 상태 (IDLE)
- 플레이어가 과일 위치 선택 중
- 좌우로 드롭 위치 조정 가능
- 다음에 나올 과일 미리보기 표시

### 2. 드롭 상태 (DROP)
- 클릭/터치 시 과일이 아래로 낙하
- 드롭 후 다음 과일이 현재 과일로 전환
- 새로운 다음 과일 랜덤 생성

### 3. 합성 상태 (MERGE)
- 같은 종류의 과일 2개가 충돌 시 발생
- 합성 위치: 두 과일의 중간점
- 상위 단계 과일로 변환 + 점수 획득

### 4. 게임오버 (GAME_OVER)
- 과일이 상단 경계선(데드라인)을 **일정 시간** 이상 초과 시 발생
- 즉시 종료가 아닌 유예 시간 부여 (약 2-3초)

## 게임 규칙 상세

### 드롭 규칙
- 드롭 가능한 과일: **체리 ~ 감** (1~5단계)
- 각 과일 출현 확률: **균등 20%**
- 드롭 후 **쿨다운**: 약 0.5초 (연속 드롭 방지)

### 합성 규칙
- 동일 과일 2개 충돌 → 상위 단계 과일 1개로 합성
- 합성 가능 조합: 체리+체리 → 딸기, 딸기+딸기 → 포도, ...
- **수박 + 수박 = 소멸** (유일한 소멸 조건)

### 경계 처리
```
      데드라인 (게임오버 판정선)
─────────────────────────────────


      왼쪽 벽 │          │ 오른쪽 벽
             │  플레이  │
             │  영역    │
             │          │
─────────────┴──────────┴─────────
              바닥
```

- **바닥/좌우 벽**: 과일 반사 (튕김)
- **상단 데드라인**: 일정 시간 이상 초과 시 게임오버

## 사용자 인터랙션

### 입력 방식

| 플랫폼 | 이동 | 드롭 |
|--------|------|------|
| 데스크톱 | 마우스 이동 / 좌우 화살표 | 클릭 / 스페이스바 |
| 모바일 | 터치 드래그 | 터치 릴리즈 (손 뗌) |

### 상태 전이

```
[시작] → [대기] ─(드롭)→ [드롭 중] ─(착지)→ [대기]
                            │
                            └─(충돌)→ [합성] → [대기]
                                        │
    [게임오버] ←──(데드라인 초과)─────────┘
```

## 특수 케이스

### 연쇄 합성 (Chain Merge)
- 합성으로 생성된 과일이 다른 동일 과일과 다시 충돌
- 연쇄 반응으로 추가 점수 획득
- 물리 시뮬레이션 특성상 자연스럽게 발생

### 동시 충돌
- 하나의 과일이 동시에 여러 동일 과일과 충돌 가능
- 처리 방식: **먼저 감지된 충돌만 처리** (1:1 합성 유지)
